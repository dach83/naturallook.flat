$(function(){function e(){var e=$(".thumbs");return-10+e.innerWidth()-e.find("ul").outerWidth(!0)}function t(){$(".thumbs");return 10}function i(i){var n=$(".thumbs");if(!(n.find("ul").outerWidth(!0)<n.innerWidth())){var d=e(),a=t();d>i?i=d:i>a&&(i=a),n.find("ul").stop(!0).animate({left:i},500)}}function n(e){if(!s){var t=$(".slider"),n=$(".thumbs"),d=t.find("li"),a=n.find("li"),l=t.find("li[data-slide-id="+e+"]");l.length||(l=d.first(),e=l.attr("data-slide-id")),l.hasClass("active")||(d.removeClass("active"),l.find(".curtain").removeAttr("style"),l.find(".handle").removeAttr("style"),l.addClass("active"));var o=d.index(l)+1+"/"+d.length;$(".slide-counter").text(o);var r=n.find("li[data-slide-id="+e+"]");if(r.length){a.removeClass("active"),r.addClass("active");var u=(n.outerWidth(!0)-1.1*r.outerWidth(!0))/2-r.position().left;i(u)}s=!0,setTimeout(function(){s=!1},100)}}function d(){var e=$(".slider li.active").attr("data-slide-id");n(e)}function a(e){e.preventDefault();var t=$(".slider li.active").prev();t.length||(t=$(".slider li").last()),n(t.attr("data-slide-id"))}function l(e){e.preventDefault();var t=$(".slider li.active").next();t.length||(t=$(".slider li").first()),n(t.attr("data-slide-id"))}function o(e,t){e.preventDefault(),0>t?l(e):t>0&&a(e)}var r=0;downMouseX=0,$(document).on("mouseup",function(){$(".handle").removeClass("drag-handle"),r=0,downMouseX=0}),$(document).on("mousedown",function(e){e.preventDefault()}),$(".handle").on("mousedown",function(e){e.preventDefault();var t=$(this);t.addClass("drag-handle"),r=t.position().left,downMouseX=e.pageX}),$(document).on("mousemove",function(e){var t=$(".drag-handle");if(t.length){var i=t.parent(".slide"),n=i.find(".curtain"),d=r+(e.pageX-downMouseX),a=100*d/i.width();0>a?a=0:a>100&&(a=100),t.css("left",a+"%"),n.css("width",a+"%")}});var s=!1;$(window).load(function(){d()}),$("#js-prev-slide").click(a),$("#js-next-slide").click(l),$(document).keydown(function(e){37==e.keyCode&&a(e),39==e.keyCode&&l(e),27==e.keyCode}),$(".slider").mousewheel(o);var u=0;$(".thumbs").mousewheel(function(n,d){n.preventDefault();var a=$(this);if(a.find("ul").outerWidth(!0)<a.innerWidth())return void o(n,d);var l=u;0>d?u-=100:d>0&&(u+=100);var r=e(),s=t();r>=u?u=r:u>=s&&(u=s),l!=u&&i(u)}),$(".thumbs li").click(function(e){e.preventDefault();var t=$(this).attr("data-slide-id");n(t)}),$(window).resize(function(){$(".thumbs ul").removeAttr("style"),d()}),$("#close-gallery").click(function(){1==history.length?window.location.href="portfolio.html":history.back()})});